<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>poi-clj.excel documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Poi-clj 0.1.5 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>poi-clj</span></div></div></li><li class="depth-2 current"><a href="poi-clj.excel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>excel</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="poi-clj.excel.html#var-add-sheet.21"><div class="inner"><span>add-sheet!</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-as-date"><div class="inner"><span>as-date</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-cell.21"><div class="inner"><span>cell!</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-cols"><div class="inner"><span>cols</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-cval"><div class="inner"><span>cval</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-load-xls"><div class="inner"><span>load-xls</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-new-xls"><div class="inner"><span>new-xls</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-row.21"><div class="inner"><span>row!</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-rows"><div class="inner"><span>rows</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-save-xls.21"><div class="inner"><span>save-xls!</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-set-style.21"><div class="inner"><span>set-style!</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-sheets"><div class="inner"><span>sheets</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-style-.3Emap"><div class="inner"><span>style-&gt;map</span></div></a></li><li class="depth-1"><a href="poi-clj.excel.html#var-write-seq.21"><div class="inner"><span>write-seq!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">poi-clj.excel</h2><div class="doc"><pre class="plaintext">Apache POI の Clojure 向け簡易ラッパー。

対応ファイルは xls (Excel 97-2003 フォーマット)のみ。
Excel エラー値(#N/A など)も扱わない。
エラー値が含まれる Excel を読み込んだ場合は例外が発生して終了する。</pre></div><div class="public anchor" id="var-add-sheet.21"><h3>add-sheet!</h3><div class="usage"><code>(add-sheet! wb)</code><code>(add-sheet! wb sheet-name)</code></div><div class="doc"><pre class="plaintext">Workbook オブジェクト wb に　sheet-name のシート名でシートを追加する。
sheet-name の指定がない場合は &quot;Sheet0&quot; で名前を付与する。</pre></div></div><div class="public anchor" id="var-as-date"><h3>as-date</h3><div class="usage"><code>(as-date cell)</code></div><div class="doc"><pre class="plaintext">数値セルの値を日付として取り出す。
</pre></div></div><div class="public anchor" id="var-cell.21"><h3>cell!</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">cell に値 v を入れる。値の型に応じて書式も設定する。
(主に POI API に日付書式自動判定入力が無い為)</pre></div></div><div class="public anchor" id="var-cols"><h3>cols</h3><div class="usage"><code>(cols row)</code></div><div class="doc"><pre class="plaintext">Row オブジェクト row に存在する Cell オブジェクトをシーケンスで返す。
</pre></div></div><div class="public anchor" id="var-cval"><h3>cval</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Excel cell 値読み取り。cell に格納されてる値に応じた Clojure データを返す。
</pre></div></div><div class="public anchor" id="var-load-xls"><h3>load-xls</h3><div class="usage"><code>(load-xls file)</code></div><div class="doc"><pre class="plaintext">指定パスの Excel を開く。
</pre></div></div><div class="public anchor" id="var-new-xls"><h3>new-xls</h3><div class="usage"><code>(new-xls)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-row.21"><h3>row!</h3><div class="usage"><code>(row! st rowidx)</code><code>(row! st rowidx coll)</code></div><div class="doc"><pre class="plaintext">指定シート st の rowidx に coll の内容を追加する。
</pre></div></div><div class="public anchor" id="var-rows"><h3>rows</h3><div class="usage"><code>(rows st)</code></div><div class="doc"><pre class="plaintext">Sheet オブジェクト st に存在する Row オブジェクトをシーケンスで返す。
</pre></div></div><div class="public anchor" id="var-save-xls.21"><h3>save-xls!</h3><div class="usage"><code>(save-xls! path wb)</code></div><div class="doc"><pre class="plaintext">Workbook オブジェクト wb を指定パス path に保存する。
</pre></div></div><div class="public anchor" id="var-set-style.21"><h3>set-style!</h3><div class="usage"><code>(set-style! cell style-map)</code></div><div class="doc"><pre class="plaintext">指定セルに各スタイルをセットする(Mutable)。

Excel はスタイル数制限が結構厳しい為、この関数ではマップデータ化した既存 CellStyle
全てと比較して、存在してない場合に初めて生成するようにしている。

スタイル数の上限チェックはしていない。</pre></div></div><div class="public anchor" id="var-sheets"><h3>sheets</h3><div class="usage"><code>(sheets wb)</code></div><div class="doc"><pre class="plaintext">Workbook オブジェクト wb に存在する Sheet オブジェクトをシーケンスで返す。
</pre></div></div><div class="public anchor" id="var-style-.3Emap"><h3>style-&gt;map</h3><div class="usage"><code>(style-&gt;map style)</code></div><div class="doc"><pre class="plaintext">CellStyle オブジェクトをマップデータ化したものを返す。Font 未対応。
</pre></div></div><div class="public anchor" id="var-write-seq.21"><h3>write-seq!</h3><div class="usage"><code>(write-seq! st nested-seq)</code></div><div class="doc"><pre class="plaintext">st の先頭から nested-seq を書き込む。
nested-seq は 2 次元ベクタで扱うため、カラム数は一致していなくても構わない。</pre></div></div></div></body></html>